@{
    ViewBag.Title = "Map Excel Columns";
    var headers = ViewBag.Headers as List<string>;
    var modelProperties = ViewBag.ModelProperties as List<string>;
}
<style>
    .table {
        width: 100%;
        margin-bottom: 20px;
        border-collapse: collapse;
    }

    .table-bordered {
        border: 1px solid #ddd;
    }

        .table-bordered th,
        .table-bordered td {
            border: 1px solid #ddd;
            padding: 8px;
        }

    .form-control {
        display: block;
        width: 100%;
        height: 34px;
        padding: 6px 12px;
        font-size: 14px;
        line-height: 1.42857143;
        color: #555;
        background-color: #fff;
        border: 1px solid #ccc;
        border-radius: 4px;
    }

    .alert-success {
        color: #3c763d;
        background-color: #dff0d8;
        border-color: #d6e9c6;
    }
</style>
<h2>Map Excel Columns to Database Fields</h2>

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">
        @TempData["ErrorMessage"]
    </div>
}

@using (Html.BeginForm("ProcessMapping", "Mapping", FormMethod.Post))
{
    @Html.AntiForgeryToken()

    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Excel Column</th>
                <th>Database Field</th>
            </tr>
        </thead>
        <tbody>
            @for (int i = 0; i < headers.Count; i++)
            {
                <tr>
                    <td>@headers[i]</td>
                    <td>
                        <select name="map_@headers[i]" class="form-control">
                            <option value="">-- Not Mapped --</option>
                            @foreach (var prop in modelProperties)
                            {
                                <option value="@prop">@prop</option>
                            }
                        </select>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <button type="submit" class="btn btn-primary">Import Data</button>
}